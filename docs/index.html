<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://unpkg.com/axios@1.5.1/dist/axios.js"></script>

<head>
  <link href="./css/output.css" rel="stylesheet" />
</head>

<div id="app" class="container mx-auto p-4">
  <div class="w-[80ch] mx-auto">
    <h1 class="text-3xl font-bold">Curated articles</h1>
    <div v-for="run in curated" class="py-4">
      <h2 class="text-2xl font-bold border-b-2 border-slate-600">
        {{ run.time_of_run }}
      </h2>
      <div v-for="(articles, journal) in run.articles" class="py-2">
        <h3 class="text-2xl">{{ journal }}</h3>
        <div
          v-for="article in articles"
          :class="{ 'bg-sky-100': article.recommendation === 'yes' }"
          class="py-2 px-2 ml-4"
        >
          <a :href="article.link" target="_blank" rel="noreferrer">
            <h4 class="text-sky-900 underline font-bold w-[90%]">
              {{ article.title }}
            </h4>
          </a>
          <p class="text-gray-700 text-justify">
            {{ article.description.replace(/(<([^>]+)>).*(<([^>]+)>)/ig, "") }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  const { createApp } = Vue;

  createApp({
    data() {
      return {
        message: "Hello Vue!",
        curated: undefined,
        onlyShowRecommended: false,
      };
    },
    async beforeMount() {
      try {
        const response = await axios.get("./curated.json", {
          responseType: "text",
        });
        console.log(response);

        const curated = [];
        for (const line of response.data.split("\n")) {
          curated.push(JSON.parse(line));
        }
        this.curated = curated;
      } catch (e) {
        console.error(e);
      }
    },
  }).mount("#app");
</script>
